# 設計方針

`koe!` の実装では、以下の方針を常に優先する。

## 1. UI とユースケースを分離する

- UI 層は表示とイベント配線だけを担当する。
- 録音開始から貼り付けまでの業務フローはアプリケーション層に集約する。

## 2. 依存方向を一方向に保つ

- UI → アプリケーション層 → インフラ層の方向のみ許可する。
- 下位層から上位層へ依存させない。

## 3. 外部境界を明示する

- API 通信、OS 権限、クリップボード操作など副作用を持つ処理は境界を分ける。
- 同一責務の通信処理やエラーハンドリングを重複実装しない。

## 4. 非同期処理のライフサイクルを管理する

- `Task` は開始・停止・破棄の責任を明示する。
- 画面状態に影響する非同期処理はキャンセル可能に実装する。

## 5. 差し替え可能性を確保する

- 外部依存はプロトコルで抽象化し、テスト時に置き換え可能な設計を保つ。
- 共有インスタンスを使う場合も、注入経路は残しておく。

## 6. 変更は小さく分離する

- 挙動変更とリファクタリングを同一変更に混在させない。
- 仕様追加は段階的に導入し、影響範囲を局所化する。
